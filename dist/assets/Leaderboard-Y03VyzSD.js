import{r as t,i as M,p as _,k as $,j as e,P as I}from"./index-kHV-VyIh.js";import{u as O}from"./quizStore-B_VpjtdZ.js";const Q=a=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"1em",height:"1em",...a},t.createElement("path",{d:"M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"})),B=a=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",width:"1em",height:"1em",...a},t.createElement("path",{d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"})),N=a=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"1em",height:"1em",...a},t.createElement("path",{d:"M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"})),P=M()(_(a=>({leaderboard:[],loading:!1,error:null,fetchLeaderboard:async(i="day",c=20,p=void 0,l=void 0,h)=>{var o,d;a({loading:!0,error:null});try{const r=await $.get("/quiz/leaderboard",{params:{type:i,size:c,category_id:p,quiz_id:l,search:h}});a({leaderboard:r.data,loading:!1})}catch(r){a({error:((d=(o=r.response)==null?void 0:o.data)==null?void 0:d.error)||"Failed to fetch leaderboard",loading:!1})}}}),{name:"leaderboard-storage",partialize:a=>({leaderboard:a.leaderboard})})),F=()=>{const[a,i]=t.useState(""),[c,p]=t.useState("დღეს"),[l,h]=t.useState(void 0),[o,d]=t.useState(void 0),[r,u]=t.useState(20),{leaderboard:y,fetchLeaderboard:g,loading:S,error:w}=P(),{categories:k,quizzes:C,fetchCategories:f,fetchCategoryQuizzes:v}=O(),z=()=>i(""),b={დღეს:"day",კვირის:"week",თვის:"month",სემესტრის:"semester",წლის:"year"};t.useEffect(()=>{f()},[f]),t.useEffect(()=>{l&&(v(Number(l)),d(void 0))},[l,v]),t.useEffect(()=>{g(b[c],r,l||void 0,o||void 0,a||void 0)},[c,r,l,o,a,g]);const L=[3,5,10,15,20,50,80,100],E=s=>{const n=Math.floor(s/60),m=Math.floor(s%60),x=Math.floor((s-Math.floor(s))*1e3);return`${n.toString().padStart(2,"0")}:${m.toString().padStart(2,"0")}:${x.toString().padStart(3,"0")}`};return e.jsxs("div",{className:"w-full min-h-screen p-4 md:p-10 flex flex-col bg-gray-50",children:[e.jsx("div",{className:"flex flex-col md:flex-row gap-4 items-stretch",children:e.jsxs("div",{className:"w-full flex justify-between items-center gap-4",children:[e.jsxs("div",{className:"relative w-full md:w-1/3",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 -translate-y-1/2 fill-main-color"}),e.jsx("input",{type:"text",value:a,onChange:s=>i(s.target.value),placeholder:"ძებნა...",className:"w-full pl-10 pr-10 bg-white h-12 rounded-xl outline-none text-sm text-main-color shadow-sm"}),a&&e.jsx("button",{onClick:z,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-black",children:e.jsx(B,{className:"fill-main-color"})})]}),e.jsxs("div",{className:"relative w-full md:w-1/3",children:[e.jsxs("select",{value:l,onChange:s=>{h(s.target.value?Number(s.target.value):void 0),d(void 0)},className:"appearance-none cursor-pointer bg-white text-main-color h-12 w-full pl-4 pr-10 rounded-xl outline-none text-sm shadow-sm",children:[e.jsx("option",{value:"",children:"ყველა კატეგორია"}),k.map(s=>e.jsx("option",{disabled:!s.has_access,value:s.id,children:s.title},s.id))]}),e.jsx("div",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx(N,{className:"fill-main-color"})})]}),l&&e.jsxs("div",{className:"relative w-full md:w-1/3",children:[e.jsxs("select",{value:o,onChange:s=>{d(s.target.value?Number(s.target.value):void 0)},className:"appearance-none cursor-pointer bg-white text-main-color h-12 w-full pl-4 pr-10 rounded-xl outline-none text-sm shadow-sm",children:[e.jsx("option",{value:"",children:"ყველა ქვიზი"}),C.map(s=>e.jsx("option",{value:s.id,children:s.title},s.id))]}),e.jsx("div",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx(N,{className:"fill-main-color"})})]})]})}),e.jsx("div",{className:"mt-6 border-y py-3",children:e.jsx("div",{className:"flex gap-x-4 flex-wrap",children:Object.keys(b).map(s=>e.jsx("button",{onClick:()=>p(s),className:`cursor-pointer text-sm md:text-base ${c===s?"underline font-semibold text-main-color":"text-gray-600"}`,children:s},s))})}),e.jsx("div",{className:"mt-4 flex gap-2 flex-wrap",children:L.map(s=>e.jsxs("button",{onClick:()=>u(s),className:`px-4 py-1 cursor-pointer rounded-md border ${r===s?"bg-main-color text-white":"bg-white text-main-color border-gray-300"}`,children:["Top ",s]},s))}),e.jsx("div",{className:"mt-6 w-full",children:S?e.jsx("p",{className:"text-gray-500",children:"იტვირთება..."}):w?e.jsx("p",{className:"text-red-500",children:w}):e.jsxs("table",{className:"w-full text-sm md:text-base bg-white shadow-sm rounded-xl overflow-hidden table-fixed",children:[e.jsx("thead",{className:"text-left bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-3 px-2 md:px-4 w-1/2 sm:w-[45%]",children:"სახელი გვარი"}),e.jsx("th",{className:"py-3 px-2 md:px-4 w-1/6 sm:w-[15%]",children:"ქულა"}),e.jsx("th",{className:"py-3 px-2 md:px-4 w-1/6 sm:w-[15%]",children:"სწორი პასუხების რაოდენობა"}),e.jsx("th",{className:"py-3 px-2 md:px-4 w-1/6 sm:w-[15%]",children:"დრო (წთ:წ:მწ)"}),e.jsx("th",{className:"py-3 px-2 md:px-4 w-1/6 sm:w-[15%]",children:"პოზიცია"})]})}),e.jsx("tbody",{children:y.map(s=>{var n,m,x,j;return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsxs("td",{className:"py-3 px-2 md:px-4 flex items-center gap-x-2",children:[e.jsx("img",{src:(m=(n=s==null?void 0:s.user)==null?void 0:n.avatar)!=null&&m.url?"https://api.sazrisi.ge"+((j=(x=s==null?void 0:s.user)==null?void 0:x.avatar)==null?void 0:j.url):I,className:"w-8 h-8 md:w-10 md:h-10 rounded-full object-cover bg-gray-300 shrink-0"}),e.jsxs("span",{className:"truncate",children:[s.user.firstname," ",s.user.lastname]})]}),e.jsx("td",{className:"py-3 px-2 md:px-4",children:e.jsx("span",{className:"bg-red-100 text-red-600 px-4 py-1 rounded-md inline-block text-center w-full sm:w-auto",children:s.total_score})}),e.jsx("td",{className:"py-3 px-2 md:px-4",children:e.jsx("span",{className:"bg-red-100 text-red-600 px-4 py-1 rounded-md inline-block text-center w-full sm:w-auto",children:s.total_score})}),e.jsx("td",{className:"py-3 px-2 md:px-4",children:e.jsx("span",{className:"bg-blue-100 text-blue-600 px-4 py-1 rounded-md inline-block text-center w-full sm:w-auto",children:s.total_time_taken_seconds?E(s.total_time_taken_seconds):"00:00:000"})}),e.jsx("td",{className:"py-3 px-2 md:px-4",children:e.jsx("span",{className:"bg-green-100 text-green-600 px-4 py-1 rounded-md inline-block shadow text-center w-full sm:w-auto",children:s.position})})]},s.position)})})]})})]})};export{F as default};
